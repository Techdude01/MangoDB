{% extends "base.html" %}

{% block title %}
Question Details
{% endblock %}

% block body %}
<div class="question-detail-container">
  <h1>{{ question.questionText }}</h1>

  {% if not user_has_responded %}
    <!-- Response submission form -->
    <form method="POST" action="{{ url_for('question_detail', question_id=question.questionID) }}">
      <textarea name="responseText" rows="4" cols="60" required placeholder="Submit your response..."></textarea><br>
      <button type="submit">Submit Response</button>
    </form>
    <p class="note">Submit a response to view others' contributions and vote on this question.</p>
  {% else %}
    <!-- Voting Controls -->
    <div class="voting-controls">
      <!-- Upvote Form -->
      <form method="POST" action="{{ url_for('vote_question') }}">
        <input type="hidden" name="question_id" value="{{ question.questionID }}">
        <input type="hidden" name="vote" value="up">
        <button type="submit">üëç Upvote</button>
      </form>
      <!-- Downvote Form -->
      <form method="POST" action="{{ url_for('vote_question') }}">
        <input type="hidden" name="question_id" value="{{ question.questionID }}">
        <input type="hidden" name="vote" value="down">
        <button type="submit">üëé Downvote</button>
      </form>
      <p>Current Votes: +{{ question.upvotes }} / -{{ question.downvotes }}</p>
    </div>

    <!-- Responses Section -->
    <div class="responses">
      <h3>Other Responses</h3>
      {% for r in responses %}
        <div class="response-item">
          {{ r.responseText }}
        </div>
      {% endfor %}
    </div>

    <!-- Comments Section -->
    <div class="comments">
      <h3>Comments</h3>
      {% for c in comments %}
        <div class="comment-item">
          {{ c.commentText }}
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <a href="{{ url_for('home') }}">üè† Back to Home</a>
</div>

<style>
    .question-detail-container { max-width: 800px; margin: auto; padding: 2rem; }
    textarea { width: 100%; padding: 0.5rem; }
    .note { font-size: 0.9rem; color: #555; margin-top: 0.5rem; }
    .voting-controls form { display: inline-block; margin-right: 1rem; }
    .responses, .comments { margin-top: 2rem; }
    .response-item, .comment-item { border-bottom: 1px solid #ccc; padding: 0.5rem 0; }
</style>
{% endblock %}
